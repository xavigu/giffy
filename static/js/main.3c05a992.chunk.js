(this.webpackJsonpgiffy=this.webpackJsonpgiffy||[]).push([[0],[,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var a="dIJrma20pSU6ymMwWnDbiaT7NFHeAGVa",r="https://api.giphy.com/v1"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1),r=n(0),c=n(15);function o(){var e=Object(r.useContext)(c.b),t=e.jwt,n=e.favs,o=e.setJWT,i=e.setFavs,l=Object(r.useState)({loading:!1,error:!1}),u=Object(a.a)(l,2),s=u[0],f=u[1],m=Object(r.useCallback)((function(e){var t=e.username,n=e.password;f({loading:!0,error:!1}),function(e){var t=e.username,n=e.password;return fetch("".concat("http://localhost:8000","/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:n})}).then((function(e){if(!e.ok)throw new Error("Response is not OK");return e.json()})).then((function(e){return e.jwt}))}({username:t,password:n}).then((function(e){window.sessionStorage.setItem("jwt",e),f({loading:!1,error:!1}),o(e)})).catch((function(e){window.sessionStorage.removeItem("jwt"),console.log(e),f({loading:!1,error:!0})}))}),[o]),d=Object(r.useCallback)((function(e){(function(e){var t=e.id,n=e.jwt;return fetch("".concat("http://localhost:8000","/favs/").concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jwt:n})}).then((function(e){if(!e.ok)throw new Error("Response is not OK");return e.json()})).then((function(e){return e.favs}))})({id:e.id,jwt:t}).then(i).catch((function(e){console.log(e)}))}),[]),g=Object(r.useCallback)((function(){window.sessionStorage.removeItem("jwt"),o(null)}),[o]);return{favs:n,addFav:d,isLogged:Boolean(t),isLoginLoading:s.loading,hasLoginError:s.error,login:m,logout:g}}},,,function(e,t,n){e.exports={"c-search":"SearchForm_c-search__hCCHg","c-search-btn":"SearchForm_c-search-btn__3re_k","c-search-list":"SearchForm_c-search-list__bmjO8","c-search-input":"SearchForm_c-search-input__2yiWd"}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(0),r=n.n(a);n(31);function c(){return r.a.createElement("div",{className:"lds-ring"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a,r=n(1),c=n(0),o=n.n(c),i=n(3),l=n(7),u=n(8),s="change_keyword",f="change_rating",m=(a={},Object(l.a)(a,s,(function(e,t){return Object(u.a)(Object(u.a)({},e),{},{times:e.times+1,keyword:t.payload})})),Object(l.a)(a,f,(function(e,t){return Object(u.a)(Object(u.a)({},e),{},{rating:t.payload})})),a),d=function(e,t){var n=m[t.type];return n?n(e,t):e};var g=n(9),h=n.n(g),v=["g","pg","pg-13","r"];function p(e){var t=e.initialKeyword,n=void 0===t?"":t,a=e.initialRating,l=void 0===a?v[0]:a,u=Object(i.e)(),m=Object(r.a)(u,2),g=(m[0],m[1]),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.initialKeyword,n=void 0===t?"":t,a=e.initialRating,o=void 0===a?"g":a,i=Object(c.useReducer)(d,{keyword:decodeURIComponent(n),rating:o}),l=Object(r.a)(i,2),u=l[0],m=u.keyword,g=u.rating,h=l[1];return{changeKeyword:function(e){var t=e.keyword;return h({type:s,payload:t})},changeRating:function(e){var t=e.rating;return h({type:f,payload:t})},keyword:m,rating:g}}({initialKeyword:n,initialRating:l}),E=p.keyword,b=p.rating,j=p.changeKeyword,w=p.changeRating;return o.a.createElement(o.a.Fragment,null,o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),function(e){var t=e.keyword;""!==t&&g("/search/".concat(t,"/").concat(b))}({keyword:E})},className:h.a["c-search"]},o.a.createElement("button",{className:h.a["c-search-btn"]},"Buscar"),o.a.createElement("input",{className:h.a["c-search-input"],placeholder:"Search a gif here...",onChange:function(e){j({keyword:e.target.value})},type:"text",value:E}),o.a.createElement("select",{className:h.a["c-search-list"],value:b,onChange:function(e){w({rating:e.target.value})}},o.a.createElement("option",{disabled:!0},"Rating:"),v.map((function(e){return o.a.createElement("option",{key:e},e)})))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(1),r=n(0),c=n(5),o=function(e){var t=e.data,n=void 0===t?[]:t;return Array.isArray(n)?n.map((function(e){var t=e.images;return{title:e.title,id:e.id,url:t.downsized_medium.url}})):[]};function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.limit,n=void 0===t?15:t,a=e.rating,r=void 0===a?"g":a,i=e.keyword,l=void 0===i?"morty":i,u=e.page,s=void 0===u?0:u,f="".concat(c.b,"/gifs/search?api_key=").concat(c.a,"&q=").concat(l,"&limit=").concat(n,"&offset=").concat(s*n,"&rating=").concat(r,"&lang=en");return fetch(f).then((function(e){return e.json()})).then(o)}var l=n(14);function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{keyword:null},t=e.keyword,n=e.rating,c=Object(r.useState)(!1),o=Object(a.a)(c,2),u=o[0],s=o[1],f=Object(r.useState)(!1),m=Object(a.a)(f,2),d=m[0],g=m[1],h=Object(r.useState)(0),v=Object(a.a)(h,2),p=v[0],E=v[1],b=Object(r.useContext)(l.b),j=b.gifs,w=b.setGifs,O=t||localStorage.getItem("lastKeyword")||"random";return Object(r.useEffect)((function(){s(!0),i({keyword:O,rating:n}).then((function(e){w(e),s(!1),localStorage.setItem("lastKeyword",t)}))}),[t,O,n,w]),Object(r.useEffect)((function(){0!==p&&(g(!0),i({keyword:O,page:p,rating:n}).then((function(e){w((function(t){return t.concat(e)})),g(!1)})))}),[O,p,n,w]),{loading:u,loadingNextPage:d,gifs:j,setPage:E}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1),r=n(0),c=n.n(r),o=c.a.createContext({});function i(e){var t=e.children,n=Object(r.useState)([]),i=Object(a.a)(n,2),l=i[0],u=i[1];return c.a.createElement(o.Provider,{value:{gifs:l,setGifs:u}},t)}t.b=o},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1),r=n(0),c=n.n(r);var o=c.a.createContext({});function i(e){var t=e.children,n=Object(r.useState)((function(){return window.sessionStorage.getItem("jwt")})),i=Object(a.a)(n,2),l=i[0],u=i[1],s=Object(r.useState)([]),f=Object(a.a)(s,2),m=f[0],d=f[1];return Object(r.useEffect)((function(){if(!l)return d([]);(function(e){var t=e.jwt;return fetch("".concat("http://localhost:8000","/favs"),{method:"GET",headers:{Authorization:t,"Content-Type":"application/json"}}).then((function(e){if(!e.ok)throw new Error("Response is not OK");return e.json()})).then((function(e){return e.favs}))})({jwt:l}).then(d)}),[l]),c.a.createElement(o.Provider,{value:{jwt:l,favs:m,setJWT:u,setFavs:d}},t)}t.b=o},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(0),r=n.n(a),c=n(3),o=n(1),i=n(6);n(32);function l(e){var t=e.id,n=e.url,a=Object(i.a)(),l=(a.isLogged,a.favs),u=a.addFav,s=Object(c.e)(),f=(Object(o.a)(s,2)[1],l.some((function(e){return e===t}))?["Remove Gif favorites","\u274c"]:["Add Gif favorites","\u2764\ufe0f"]),m=Object(o.a)(f,2),d=m[0],g=m[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"fav-button",onClick:function(){navigator.clipboard.writeText(n)}},r.a.createElement("span",{"aria-label":"Copy to clipboard",role:"img"},"\ud83d\udd17")),r.a.createElement("button",{className:"fav-button",onClick:function(){console.log(t),u({id:t})}},r.a.createElement("span",{"aria-label":d,role:"img"},g)))}n(33);function u(e){var t=e.title,n=e.id,a=e.url;return r.a.createElement("div",{className:"Gif"},r.a.createElement("div",{className:"Gif-buttons"},r.a.createElement(l,{id:n,url:a})),r.a.createElement(c.a,{to:"/gif/".concat(n),className:"Gif-link"},r.a.createElement("h4",null,t),r.a.createElement("img",{loading:"lazy",alt:t,src:a})))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0),r=n.n(a),c=n(16);n(34);function o(e){var t=e.gifs;return r.a.createElement("div",{className:"ListOfGifs"},t.map((function(e){var t=e.id,n=e.title,a=e.url;return r.a.createElement(c.a,{id:t,key:t,title:n,url:a})})))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(1),r=n(0);function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.distance,c=void 0===t?"100px":t,o=e.externalRef,i=e.once,l=void 0===i||i,u=Object(r.useState)(!1),s=Object(a.a)(u,2),f=s[0],m=s[1],d=Object(r.useRef)();return Object(r.useEffect)((function(){var e,t=o?o.current:d.current,a=function(e,t){e[0].isIntersecting?(m(!0),l&&t.disconnect()):!l&&m(!1)};return Promise.resolve("undefined"!==typeof IntersectionObserver?IntersectionObserver:n.e(5).then(n.t.bind(null,40,7))).then((function(){e=new IntersectionObserver(a,{rootMargin:c}),t&&e.observe(t)})),function(){return e&&e.disconnect()}})),{isNearScreen:f,fromRef:d}}},,,,,function(e,t,n){e.exports=n(39)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(20),o=n.n(c),i=(n(29),n(3)),l=n(6);n(30);function u(){var e=Object(l.a)(),t=e.isLogged,n=e.logout;return r.a.createElement("header",{className:"gf-header"},t?r.a.createElement(i.a,{href:"#",onClick:function(e){e.preventDefault(),n()}},"Logout"):r.a.createElement(i.a,{to:"/login"},"Login"))}var s=n(1);function f(){var e=Object(a.useState)(""),t=Object(s.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(""),u=Object(s.a)(o,2),f=u[0],m=u[1],d=Object(i.e)(),g=Object(s.a)(d,2)[1],h=Object(l.a)(),v=h.isLoginLoading,p=h.hasLoginError,E=h.login,b=h.isLogged;Object(a.useEffect)((function(){b&&g("/")}),[b,g]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Login"),v&&r.a.createElement("strong",null,"Checking credentials..."),!v&&r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),E({username:n,password:f})}},r.a.createElement("input",{placeholder:"username",onChange:function(e){return c(e.target.value)},value:n}),r.a.createElement("input",{type:"password",placeholder:"password",onChange:function(e){return m(e.target.value)},value:f}),r.a.createElement("button",null,"Login")),p&&r.a.createElement("strong",null,"Credentials Invalid"))}var m=n(11),d=n(18),g=n(12),h=n(13),v=n(19),p=n(21),E=n.n(p),b=n(4);function j(e){var t=e.params,n=t.keyword,c=t.rating,o=Object(h.a)({keyword:n,rating:c}),i=o.loading,l=o.gifs,u=o.setPage,s=Object(a.useRef)(),f=Object(v.a)({externalRef:i?null:s,once:!1}).isNearScreen,p=l?"".concat(l.length," resultados de ").concat(n):"",j=Object(a.useCallback)(E()((function(){return u((function(e){return e+1}))}),200),[u]);return Object(a.useEffect)((function(){f&&j()}),[j,f]),r.a.createElement(r.a.Fragment,null,i?r.a.createElement(m.a,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,null,r.a.createElement("title",null,p),r.a.createElement("meta",{name:"description",content:p}),r.a.createElement("meta",{name:"rating",content:"General"})),r.a.createElement("header",{className:"o-header"},r.a.createElement(g.a,{initialKeyword:n,initialRating:c})),r.a.createElement("div",{className:"App-wrapper"},r.a.createElement("h3",{className:"App-title"},decodeURI(n)),r.a.createElement(d.a,{gifs:l}),r.a.createElement("div",{id:"visor",ref:s}))))}var w=n(16),O=n(5),y=function(e){var t=e.data,n=t.images;return{title:t.title,id:t.id,url:n.downsized_medium.url}};function k(e){var t=e.id,n=Object(h.a)().gifs.find((function(e){return e.id===t})),r=Object(a.useState)(n),c=Object(s.a)(r,2),o=c[0],i=c[1],l=Object(a.useState)(!1),u=Object(s.a)(l,2),f=u[0],m=u[1],d=Object(a.useState)(!1),g=Object(s.a)(d,2),v=g[0],p=g[1];return Object(a.useEffect)((function(){o||(m(!0),function(e){var t=e.id;return fetch("".concat(O.b,"/gifs/").concat(t,"?api_key=").concat(O.a)).then((function(e){return e.json()})).then(y)}({id:t}).then((function(e){i(e),m(!1),p(!1)})).catch((function(e){m(!1),p(!0)})))}),[o,t]),{gif:o,isLoading:f,isError:v}}function S(e){var t=k({id:e.params.id}),n=t.gif,a=t.isLoading,c=t.isError,o=n?n.title:"";return a?r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,null,r.a.createElement("title",null,"Cargando...")),r.a.createElement(m.a,null)):c?r.a.createElement(i.b,{to:"/404"}):n?r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,null,r.a.createElement("title",null,o," || Giffy")),r.a.createElement("h3",{className:"App-title"},n.title),r.a.createElement(w.a,n)):null}var N=["d2jjuAZzDSVLZ5kI","Bp3dFfoqpCKFyXuSzP","hv5AEBpH3ZyNoRnABG","hLwSzlKN8Fi6I"];function C(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,null,r.a.createElement("title",null,"Error 404 | Giffy")),r.a.createElement("header",{className:"o-header"},r.a.createElement(g.a,null)),r.a.createElement("div",{className:"App-wrapper"},r.a.createElement("div",{className:"App-main page-error"},r.a.createElement("span",{class:"code-error"},"404"),r.a.createElement("span",{class:"msg-error"},"Sometimes gettings lost isn't that bad"),r.a.createElement("img",{class:"gif-error",src:"https://media.giphy.com/media/".concat(N[Math.floor(Math.random()*N.length)+1],"/giphy.gif"),alt:"alt-page-404"}),r.a.createElement(i.a,{href:"/",class:"btn"},"Go to home"))))}var F=n(15),R=n(14),L=(n(38),r.a.lazy((function(){return n.e(4).then(n.bind(null,43))})));function _(){return r.a.createElement(F.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(a.Suspense,{fallback:null},r.a.createElement("section",{className:"App-content"},r.a.createElement(u,null),r.a.createElement(i.a,{to:"/"},r.a.createElement("figure",{className:"App-logo"},r.a.createElement("img",{alt:"Giffy logo",src:"/logo.png"}))),r.a.createElement(R.a,null,r.a.createElement(i.d,null,r.a.createElement(i.c,{component:L,path:"/"}),r.a.createElement(i.c,{component:j,path:"/search/:keyword/:rating?"}),r.a.createElement(i.c,{component:S,path:"/gif/:id"}),r.a.createElement(i.c,{component:f,path:"/login"}),r.a.createElement(i.c,{component:C,path:"/:rest*"})))))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[24,1,2]]]);
//# sourceMappingURL=main.3c05a992.chunk.js.map